<Page
    x:Class="WaterMeasurements.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:esri="using:Esri.ArcGISRuntime.UI.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:media="using:CommunityToolkit.WinUI.Media"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:viewmodels="using:WaterMeasurements.ViewModels"
    x:Name="MapPage"
    d:DataContext="{d:DesignInstance Type=viewmodels:MainViewModel}"
    Background="{ThemeResource SolidBackgroundFillColorBaseBrush}"
    mc:Ignorable="d">

    <Page.Resources>
        <!--  We expect all our elements to bind to the same target with this resource  -->
        <ui:AttachedDropShadow
            x:Key="CommonShadow"
            CastTo="{x:Bind CollectionStackPanel}"
            Offset="8" />
    </Page.Resources>


    <Grid
        x:Name="ContentArea"
        Height="Auto"
        VerticalAlignment="Top"
        ColumnSpacing="18"
        FlowDirection="LeftToRight">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition />

        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition MinWidth="500" MaxWidth="800" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <Grid
            x:Name="TitleBar"
            Grid.Row="0"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Height="110"
            VerticalAlignment="Top"
            Background="{ThemeResource AcrylicBackgroundFillColorDefaultBrush}"
            Visibility="Visible">
            <TextBlock
                x:Name="TitleBarText"
                x:Uid="Main_Title"
                Margin="12,0,0,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Style="{StaticResource TitleTextBlockStyle}" />
            <StackPanel>
                <ComboBox
                    x:Name="ViewSelector"
                    Width="200"
                    Margin="10,45,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Bottom"
                    Header="Select View"
                    SelectedIndex="0">
                    <x:String>Map</x:String>
                    <x:String>Configuration</x:String>
                    <x:String>Startup</x:String>
                </ComboBox>
            </StackPanel>
        </Grid>

        <Grid
            Grid.Row="1"
            Grid.Column="0"
            FlowDirection="LeftToRight">

            <controls:SwitchPresenter x:Name="UiViews" Value="{Binding SelectedItem, ElementName=ViewSelector}">

                <controls:Case Value="Map">

                    <StackPanel>

                        <NavigationView IsBackButtonVisible="Collapsed" PaneDisplayMode="Top">
                            <NavigationView.MenuItems>
                                <NavigationViewItem Content="Center">
                                    <NavigationViewItem.Icon>
                                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE81D;" />
                                    </NavigationViewItem.Icon>
                                </NavigationViewItem>
                                <NavigationViewItem Content="Auto Pan">
                                    <NavigationViewItem.Icon>
                                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe7c2;" />
                                    </NavigationViewItem.Icon>
                                </NavigationViewItem>
                            </NavigationView.MenuItems>

                            <Frame x:Name="MapFrame" />
                        </NavigationView>

                        <StackPanel>
                            <CommandBar
                                HorizontalAlignment="Left"
                                DefaultLabelPosition="Right"
                                IsOpen="False">
                                <AppBarButton Label="Center">
                                    <AppBarButton.Icon>
                                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE81D;" />
                                    </AppBarButton.Icon>
                                </AppBarButton>
                                <AppBarButton Label="Auto Pan">
                                    <AppBarButton.Icon>
                                        <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe7c2;" />
                                    </AppBarButton.Icon>
                                </AppBarButton>
                            </CommandBar>
                        </StackPanel>

                        <StackPanel BorderThickness="6" CornerRadius="3">
                            <esri:MapView
                                x:Name="MapView"
                                MinWidth="500"
                                MinHeight="500"
                                MaxWidth="800"
                                MaxHeight="800"
                                Map="{x:Bind ViewModel.CurrentMap, Mode=TwoWay}" />
                        </StackPanel>

                    </StackPanel>

                </controls:Case>

                <controls:Case Value="Configuration">

                    <StackPanel x:Name="SettingsPanel" Margin="25,10,0,0">
                        
                        <TextBlock
                            x:Uid="Settings_Developer"
                            Margin="{StaticResource SmallTopMargin}"
                            Style="{ThemeResource SubtitleTextBlockStyle}" />
                        
                        <StackPanel Margin="20,15,0,0">

                            <TextBlock x:Uid="Settings_ApiKey" />

                            <StackPanel Margin="10,0,0,0" Orientation="Horizontal">
                                <PasswordBox
                                    Name="ApiKeyArcGIS"
                                    Width="400"
                                    Margin="0,5,10,0"
                                    AutomationProperties.Name="ArcGIS API key password box"
                                    LostFocus="{x:Bind StoreDeveloperKeyAsync, Mode=OneWay}"
                                    Password="{x:Bind apiKey, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"
                                    PasswordRevealMode="Hidden" />
                                <CheckBox
                                    Name="RevealApiKey"
                                    x:Uid="Settings_RevealApiKey"
                                    Checked="RevealApiKey_Changed"
                                    IsChecked="False"
                                    Unchecked="RevealApiKey_Changed" />
                            </StackPanel>

                            <TextBlock x:Uid="Settings_WebMapId" Margin="0,20,0,0" />

                            <TextBox
                                x:Name="WebMapId"
                                MinWidth="400"
                                Margin="10,5,10,0"
                                HorizontalAlignment="Left"
                                LostFocus="{x:Bind StoreWebMapIdAsync, Mode=OneWay}"
                                Text="{x:Bind webMapId, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" />

                            <TextBlock x:Uid="Settings_PreplannedMapName" Margin="0,20,0,0" />

                            <TextBox
                                x:Name="PreplannedMapName"
                                MinWidth="400"
                                Margin="10,5,10,0"
                                HorizontalAlignment="Left"
                                LostFocus="{x:Bind StorePreplannedMapNameAsync, Mode=OneWay}"
                                Text="{x:Bind preplannedMapName, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" />

                        </StackPanel>
                    
                    </StackPanel>

                </controls:Case>

            </controls:SwitchPresenter>

        </Grid>

        <Grid
            x:Name="Notifications"
            Grid.Row="1"
            Grid.Column="1">

            <TabView
                x:Name="SecchiTab"
                MinHeight="475"
                Margin="0"
                IsAddTabButtonVisible="False"
                SelectedIndex="0">

                <TabView.Resources>
                    <ResourceDictionary>
                        <ResourceDictionary.ThemeDictionaries>
                            <ResourceDictionary x:Key="Light">
                                <SolidColorBrush x:Key="TabViewBackground" Color="{ThemeResource SystemAccentColorLight3}" />
                            </ResourceDictionary>
                            <ResourceDictionary x:Key="Dark">
                                <SolidColorBrush x:Key="TabViewBackground" Color="{ThemeResource SystemAccentColorDark3}" />
                            </ResourceDictionary>
                        </ResourceDictionary.ThemeDictionaries>
                    </ResourceDictionary>
                </TabView.Resources>

                <TabView.TabItems>
                    <TabViewItem Header="Secchi" IsClosable="False">
                        <TabViewItem.IconSource>
                            <SymbolIconSource Symbol="Page" />
                        </TabViewItem.IconSource>

                        <StackPanel
                            x:Name="CollectionStackPanel"
                            Margin="0,10,0,0"
                            HorizontalAlignment="Left"
                            Visibility="Visible">

                            <StackPanel x:Name="DatatableStackPanel" Margin="{StaticResource SmallTopMargin}">

                                <StackPanel Background="{ThemeResource AcrylicBackgroundFillColorDefaultBrush}">
                                    <CommandBar
                                        Margin="0,0,0,0"
                                        HorizontalAlignment="Left"
                                        DefaultLabelPosition="Right"
                                        IsOpen="False">
                                        <AppBarButton Label="Upload">
                                            <AppBarButton.Icon>
                                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe898;" />
                                            </AppBarButton.Icon>
                                        </AppBarButton>
                                        <AppBarButton Label="Discard">
                                            <AppBarButton.Icon>
                                                <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xe711;" />
                                            </AppBarButton.Icon>
                                        </AppBarButton>
                                    </CommandBar>
                                </StackPanel>

                                <ListView Visibility="Visible">
                                    <ListView.Header>
                                        <controls:DataTable Margin="0,10,0,0" ColumnSpacing="1">
                                            <controls:DataColumn CanResize="True" DesiredWidth="120">
                                                <TextBlock
                                                    FontWeight="Bold"
                                                    Opacity=".8"
                                                    Style="{StaticResource BodyTextStyle}"
                                                    Text="Location" />
                                            </controls:DataColumn>
                                            <controls:DataColumn MinWidth="80" CanResize="True">
                                                <TextBlock
                                                    FontWeight="Bold"
                                                    Opacity=".8"
                                                    Style="{StaticResource BodyTextStyle}"
                                                    Text="Obs1" />
                                            </controls:DataColumn>
                                            <controls:DataColumn MinWidth="80" CanResize="True">
                                                <TextBlock
                                                    FontWeight="Bold"
                                                    Opacity=".8"
                                                    Style="{StaticResource BodyTextStyle}"
                                                    Text="Obs2" />
                                            </controls:DataColumn>
                                            <controls:DataColumn MinWidth="80" CanResize="True">
                                                <TextBlock
                                                    FontWeight="Bold"
                                                    Opacity=".8"
                                                    Style="{StaticResource BodyTextStyle}"
                                                    Text="Obs3" />
                                            </controls:DataColumn>
                                            <controls:DataColumn MinWidth="40" CanResize="True">
                                                <TextBlock
                                                    FontWeight="Bold"
                                                    Opacity=".8"
                                                    Style="{StaticResource BodyTextStyle}"
                                                    Text="Secchi" />
                                            </controls:DataColumn>
                                        </controls:DataTable>
                                    </ListView.Header>
                                </ListView>
                            </StackPanel>

                            <StackPanel
                                x:Name="ManualCollectionStackPanel"
                                Width="200"
                                Margin="0,100,0,0"
                                HorizontalAlignment="Left"
                                Visibility="Visible">

                                <TextBlock
                                    Opacity="0.8"
                                    Style="{StaticResource TitleTextBlockStyle}"
                                    Text="HOA Test"
                                    TextAlignment="Left" />

                                <TextBlock
                                    x:Uid="Main_SecchiValues"
                                    HorizontalAlignment="Left"
                                    Opacity=".5"
                                    Style="{StaticResource SubtitleTextBlockStyle}" />
                                <TextBox
                                    x:Name="Measurement1"
                                    Margin="{StaticResource SmallTopMargin}"
                                    ui:TextBoxExtensions.ValidationMode="Dynamic"
                                    ui:TextBoxExtensions.ValidationType="Number"
                                    InputScope="Digits" />
                                <TextBox
                                    x:Name="Measurement2"
                                    ui:TextBoxExtensions.ValidationMode="Dynamic"
                                    ui:TextBoxExtensions.ValidationType="Number"
                                    InputScope="Digits" />
                                <TextBox
                                    x:Name="Measurement3"
                                    ui:TextBoxExtensions.ValidationMode="Dynamic"
                                    ui:TextBoxExtensions.ValidationType="Number"
                                    InputScope="Digits" />

                                <StackPanel
                                    x:Name="ButtonStackPanel"
                                    Margin="{StaticResource SmallTopMargin}"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Orientation="Horizontal"
                                    Spacing="5">
                                    <Button x:Name="SecchiSaveButton" x:Uid="Main_SecchiSaveButton" />
                                    <Button x:Name="SecchiCancelButton" x:Uid="Main_SecchiCancelButton" />
                                </StackPanel>

                            </StackPanel>

                        </StackPanel>


                    </TabViewItem>
                    <TabViewItem Header="Water Quality" IsClosable="False">
                        <TabViewItem.IconSource>
                            <SymbolIconSource Symbol="Page" />
                        </TabViewItem.IconSource>
                    </TabViewItem>

                </TabView.TabItems>
            </TabView>

        </Grid>

    </Grid>
</Page>
